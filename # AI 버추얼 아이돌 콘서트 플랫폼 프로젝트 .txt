# AI 버추얼 아이돌 콘서트 플랫폼 프로젝트 MVE (Move Studio)

## 프로젝트 개요
언리얼 엔진 5.6.1 기반의 AI 기반 버추얼 아이돌 실시간 콘서트 플랫폼 개발 프로젝트입니다. 방송인은 프리셋 캐릭터 또는 커스텀 GLB 모델로 콘서트를 진행하고, 시청자는 AI를 활용해 응원봉과 액세서리를 실시간으로 생성하여 콘서트에 참여할 수 있는 인터랙티브 VTubing 플랫폼을 목표로 합니다.

## 핵심 기능 모듈

### 1. 캐릭터 시스템

#### 방송인 캐릭터 시스템
- **프리셋 캐릭터 제공**: 기본 제공되는 고품질 캐릭터 세트
- **GLB 파일 업로드 지원**: 사용자 커스텀 GLB 모델 업로드 및 적용
- **런타임 모델 로딩 시스템**: 실시간 캐릭터 로딩 (glTFRuntime 플러그인)
- **캐릭터 프리뷰 기능**: 3D 뷰포트에서 실시간 프리뷰
- **캐릭터 선택 UI**: 프리셋 선택 및 파일 업로드 인터페이스

#### 시청자 액세서리 커스터마이징 시스템
- **AI 기반 액세서리 생성**: 프롬프트 + 참고 이미지로 응원봉/액세서리 생성
- **ComfyUI 서버 연동**: AI 이미지 생성 파이프라인
- **실시간 3D 프리뷰**: 생성된 액세서리 미리보기 (회전, 확대/축소)
- **소켓 기반 부착 시스템**: 시청자 캐릭터의 손/머리 등에 동적 부착
- **액세서리 카테고리**: 응원봉, 머리 장식, 손 장식, 등 장식 등
- **단일 액세서리 적용**: 시청자당 하나의 액세서리만 장착 가능

### 2. 무대 환경 시스템
- **환경 에셋 데이터테이블 구조**: 무대, 배경, 소품 등의 에셋 정보 관리
- **데이터테이블 기반 에셋 관리**: 효율적인 에셋 로딩 및 관리
- **AI 기반 무대 환경 자동 선택**: 가사 분석을 통한 적합한 무대 에셋 자동 매칭
- **런타임 무대 환경 전환**: 실시간으로 무대 환경 변경
- **음악 동기화 조명 시스템**: 가사 및 음악 구조 기반 동적 조명 제어
- **배경 효과 자동 전환**: 음악 분위기에 따른 자동 배경 전환

### 3. 음악 재생 시스템
- **자체 스트리밍 서버**: 커스텀 음악 스트리밍 서버 구축
- **스트리밍 서버 API**: 음원 재생 및 메타데이터 제공 API
- **AI 가사 분석**: LLM 기반 가사 분석 및 무대 환경 매칭
- **무대 환경 데이터베이스 연동**: 분석된 가사에 맞는 무대 에셋 자동 선택
- **런타임 중 음원 재생**: 실시간 음악 재생 기능
- **재생 인터페이스 UI**: 플레이어 UI (재생/일시정지/정지/스킵)
- **음악 메타데이터 표시**: 곡 정보, 아티스트 정보 표시
- **재생 목록 관리**: 플레이리스트 관리 기능

### 4. 실시간 채팅 시스템
- **채팅 시스템 아키텍처**: ChatManager 기반 구조 설계
- **AI 기반 커스텀 필터링**: LLM 에이전트를 활용한 지능형 메시지 필터링
- **욕설/부적절한 내용 탐지**: AI 기반 컨텍스트 이해 필터링
- **Rate Limiting**: 메시지 속도 제한 및 스팸 방지
- **채팅 이력 관리**: 메시지 로그 저장 및 안정성
- **채팅 입력/표시 UI**: 채팅 입력창 및 메시지 리스트

### 5. 시청자 인터랙션 시스템
- **이모트/리액션 시스템**: 이모티콘 및 리액션 표현
- **응원봉 조작**: AI 생성 응원봉 흔들기/조작
- **파티클 효과**: 응원 시 파티클 및 이벤트 효과
- **동기화 응원**: 다수의 시청자 동시 응원 효과

### 6. 멀티플레이어 네트워크 시스템
- **Listen 서버 구조**: 방송인이 호스트 서버 역할
- **SessionManager**: 방송 룸 생성/검색/입장 시스템
- **서버-클라이언트 동기화**: 캐릭터, 액세서리, 이펙트 동기화

### 7. UI 시스템
- **[공통] 시작화면**: 메인 메뉴
- **[공통] 로그인/회원가입**: 사용자 인증 화면
- **[공통] 모드 선택**: 방송인/시청자 모드 선택
- **[스튜디오] 캐릭터 선택 화면**: 프리셋 선택 또는 GLB 업로드
- **[스튜디오] 캐릭터 프리뷰 화면**: 3D 뷰포트 프리뷰
- **[스튜디오] 방송 설정 화면**: 방송 룸 설정 (제목, 설명 등)
- **[스튜디오] 방송 화면**: 방송 중 제어 UI
- **[오디언스] 콘서트 룸 검색/목록**: 참가 가능한 방송 검색
- **[오디언스] 액세서리 커스터마이징**: AI 생성 인터페이스 (프롬프트 입력, 참고 이미지, 카테고리 선택) + 액세서리 프리뷰 (3D 회전/확대 프리뷰)
- **[오디언스] 콘서트 시청 화면**: 실시간 시청 및 인터랙션

### 8. 로그인/회원가입 시스템
- **사용자 정보 암호화**: 비밀번호 해싱 및 보안 처리
- **사용자 인증**: 로그인/회원가입 구현
- **데이터베이스 연동**: 사용자 정보 및 생성 데이터 저장
- **세션 관리**: 토큰 기반 세션 관리

## 기술 스택

### 엔진 & 프레임워크
- **Unreal Engine 5.6.1**: 메인 개발 엔진
- **C++**: 코어 시스템 개발 언어
- **Blueprint**: UI 및 프로토타이핑

### AI & 콘텐츠 생성
- **ComfyUI**: AI 기반 2D 이미지 생성 (액세서리)
- **LLM (가사 분석)**: 음악 가사 분석 및 무대 환경 매칭
- **LLM (채팅 필터링)**: AI 에이전트 기반 지능형 메시지 필터링

### 3D 파이프라인
- **glTFRuntime 플러그인**: 런타임 GLB 파일 로딩

### 네트워크
- **Listen 서버**: 방송인 호스트 서버
- **SessionManager (GameInstanceSubsystem)**: 세션 생성/검색/입장

### 서버 & API
- **자체 음악 스트리밍 서버**: 커스텀 음원 스트리밍 서비스
- **Node.js + Express**: 스트리밍 서버 API
- **AWS 기반 백엔드**: 사용자 정보 및 생성 데이터 관리
- **Redis**: 세션 관리 및 캐싱

### 외부 API
- **MediaPipe/Live Link**: 실시간 얼굴 표정 트래킹
- **Remocapp**: 실시간 모션 트래킹

### 데이터베이스
- **사용자 정보**: 로그인, 회원가입 데이터
- **무대 환경 에셋 DB**: 가사 분석 결과와 매칭되는 무대 에셋 정보
- **음악 메타데이터**: 곡 정보, 아티스트 정보, 가사

## 개발 우선순위

### Phase 1: 기초 인프라 ✅
1. ~~로그인/회원가입 시스템~~
2. ~~데이터베이스 연동~~
3. ~~기본 UI 시스템 (UIManagerSubsystem)~~
4. ~~세션 관리 시스템~~

### Phase 2: 캐릭터 & 액세서리 시스템 (현재 진행 중)
1. ~~방송인 프리셋 캐릭터 준비~~
2. ~~GLB 파일 업로드 및 런타임 로딩~~
3. **시청자 액세서리 커스터마이징 UI** 🔄
4. **ComfyUI + TripoSR 파이프라인 연동** 🔄
5. **3D 프리뷰 시스템 (회전/확대)** 🔄
6. **소켓 기반 액세서리 부착** 🔄

### Phase 3: 멀티플레이어 & 네트워크
1. ~~SessionManager 구현~~
2. ~~방송 룸 생성/검색/입장~~
3. Listen 서버 구현
4. 액세서리 동기화
5. 클라이언트 권한 처리

### Phase 4: 음악 & 무대 환경
1. 자체 스트리밍 서버 구축
2. 스트리밍 서버 API 개발
3. AI 가사 분석 시스템
4. 무대 환경 데이터베이스 구축
5. 가사-무대 에셋 매칭 알고리즘
6. 런타임 무대 전환 시스템
7. 조명 동기화 시스템

### Phase 5: 채팅 & 인터랙션
1. ChatManager 구현
2. AI 기반 커스텀 필터링 시스템
3. Rate Limiting 및 스팸 방지
4. 채팅 UI 구현
5. 이모트/응원봉 시스템
6. 파티클 효과

### Phase 6: 최적화 & 배포
1. Studio/Audience 빌드 분리
2. 네트워크 최적화
3. 메모리 최적화
4. 최종 통합 테스트
5. 배포 준비

## 주요 변경사항
- ✅ **추가**: 방송인용 프리셋 캐릭터 + GLB 업로드 지원
- ✅ **추가**: 시청자용 AI 액세서리 생성 시스템 (단일 액세서리)
- ✅ **추가**: 소켓 기반 액세서리 부착 시스템
- ✅ **추가**: 자체 음악 스트리밍 서버 및 API
- ✅ **추가**: AI 가사 분석 기반 무대 환경 자동 선택
- ✅ **추가**: AI 에이전트 기반 채팅 필터링 시스템
- ✅ **변경**: ComfyUI → 액세서리 생성 파이프라인으로 재활용

## 주의사항 & 개발 가이드

### 코딩 스타일
- **C++ 중심 개발**: 성능 중요 코어 시스템 (SessionManager, ChatManager 등)
- **Blueprint 활용**: UI 위젯 및 간단한 로직
- **언리얼 코딩 컨벤션 준수**: UE5 공식 표준

### 성능 최적화
- **런타임 로딩 최적화**: GLB 비동기 로딩 (glTFRuntime)
- **메모리 관리**: 스마트 포인터 및 가비지 컬렉션
- **네트워크 최적화**: RPC 호출 최소화, 대역폭 관리
- **스트리밍 서버 최적화**: 캐싱 및 대역폭 제어

### 보안
- **클라이언트 시크릿 분리**: API 키는 서버 측에서만 관리
- **사용자 정보 암호화**: 비밀번호 해싱
- **AI 필터링 우회 방지**: 다층 필터링 검증
- **권한 검증**: 서버 권한(HasAuthority) 체크
- **스트리밍 서버 인증**: 토큰 기반 인증

### 확장성 고려
- **모듈화 설계**: Subsystem 기반 아키텍처
- **데이터테이블 활용**: 무대 에셋, 프리셋 캐릭터 관리
- **플러그인 구조**: glTFRuntime, MediaPipe 등 독립 모듈
- **무대 에셋 DB 확장**: 새로운 무대 환경 추가 용이성

## 참고 문서
- Unreal Engine 5.6.1 공식 문서
- glTF 2.0 스펙
- glTFRuntime 플러그인 문서
- Node.js Stream API 문서

## 프로젝트 목표
**2개월 포트폴리오 프로젝트**로, 언리얼 엔진 5 고급 프로그래머 역량 증명을 목표로 합니다.

### 포트폴리오 핵심 어필 포인트
1. **멀티플레이어 네트워킹**: Listen 서버 
2. **AI 통합**: 
   - ComfyUI 런타임 3D 생성 파이프라인
   - AI 가사 분석 기반 무대 환경 자동 선택
   - AI 에이전트 기반 지능형 채팅 필터링
3. **런타임 시스템**: glTFRuntime 기반 동적 에셋 로딩
4. **자체 스트리밍 서버**: 커스텀 음악 스트리밍 서비스 구축
5. **고급 UI 아키텍처**: MVC 패턴
6. **실시간 인터랙션**: 채팅, 이모트, 액세서리 동기화